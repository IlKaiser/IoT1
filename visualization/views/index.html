<html>
<head>
    <!-- Info -->
    <meta charset="utf-8">

    <title>IoT1</title>

    <meta name="description" content="IoT1">
    <meta name="author" content="Marco Calamo 1808240">

    <!-- Style -->
    <link rel="stylesheet" href="dashboard.css">  
    
    <!-- JS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        //Get listener
        $.get( "/data", function( data ) {
            $( "#display").text(data);
        });
    </script>
    <script>
        //Post on button_on pressed
        $( document ).ready(function() {
            $("#button_on").click( function(){
                $("#button_on").attr("disabled", true);
               
                fetch('/mqtt', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        turn: "on"
                    })
                });
                
                $("#button_off").attr("disabled", false);
            });
            $("#button_off").click( function(){
                $("#button_off").attr("disabled", true);
                fetch('/mqtt', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        turn: "off"
                    })
                });
                $("#button_on").attr("disabled", false); 
            });
        });
    </script>
</head>
<body>
    <div class="container">
        <div class="row">
            <h1>Forza Giuve Sium</h1>
        </div>
        <div class="row">
            <div class="col">
                <button id="button_on" class="btn btn-primary">Light it up</button>
            </div>
            <div class="col">
                <button id="button_off" class="btn btn-danger" disabled="true">Turn it off</button>
            </div>
        </div>
        <div class="row">
            <div id="display"></div>
        </div>
    </div>
        
    
    
</body>
